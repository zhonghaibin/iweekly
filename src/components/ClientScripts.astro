---
// Client-side scripts for image optimization and interactions
---

<script type='text/javascript' src='https://gw.alipayobjects.com/os/k/h3/heti-addon.min.js' is:inline></script>
<script type='text/javascript' src='https://gw.alipayobjects.com/os/k/3j/lozad.min.js' is:inline></script>
<script type='text/javascript' src='https://gw.alipayobjects.com/os/k/s3/lightense.min.js' is:inline></script>

<!-- Google Analytics -->
<script async src='https://www.googletagmanager.com/gtag/js?id=G-DT01FBW30E' is:inline></script>
<script is:inline>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());
  gtag('config', 'G-DT01FBW30E');
</script>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    // Optimization of letter spacing
    if (typeof Heti !== 'undefined') {
      const heti = new Heti('.heti');
      heti.autoSpacing();
    }

    // Lazy loading of images
    if (typeof lozad !== 'undefined') {
      const observer = lozad('.lozad', {
        loaded: (el) => {
          el.alt = el.getAttribute('data-alt');
        },
      });
      observer.observe();
    }

    // Open external links in a new tab
    Array.from(document.links).forEach((link) => {
      if (link.hostname !== window.location.hostname) {
        link.target = '_blank';
        link.rel = 'noopener noreferrer';
      }
    });

    // Image zoom functionality
    const zoomImgs = document.querySelectorAll('#write>img, #write>p>img, #write>table img');
    if (zoomImgs.length > 0 && typeof Lightense !== 'undefined') {
      Lightense(zoomImgs, {
        background: 'rgba(255, 255, 255, .8)',
      });
    }

    // Lazy load images after the first two
    const images = document.querySelectorAll("#write img");
    images.forEach((img, index) => {
      if (index > 1) {
        img.setAttribute("loading", "lazy");
        img.setAttribute("decoding", "async");
      }
    });
  });
</script>